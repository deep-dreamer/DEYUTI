<!DOCTYPE html>
<html lang="ja">
    <head prefix="og: http://ogp.me/ns# website: http://ogp.me/ns/website#">
        <meta charset="UTF-8">
        <!--文字コードは上のほうにないとすべておしまいになるらしい-->
        <meta name="description" content="カードゲーム作りたい">
        <title>JUN汁ｗおもちゃばこ。/おもちゃ/しゅうくんカード</title>
        <!--OGPとかいうの-->
        <meta property="og:site_name" content="JUN汁ｗおもちゃばこ。/omocha/syuukun_card">                                <!--タイトル　入力すること！-->
        <meta property="og:title" content="しゅうくんカード">                                                               <!--タイトル　入力すること！-->
        <meta property="og:type" content="article"> <!--websiteはトップページ、articleが記事だってさ-->
        <meta property="og:url" content="https://junjiruw.github.io/DEYUTI/omocha/syuukun_card.html">                   <!--リンク　入力すること！-->
        <meta property="og:image" content="https://github.com/junjiruw/DEYUTI/blob/master/images/site/junjiruw_bako.png?raw=true">
        <meta name="twitter:card" content="summary"><!--なにを表示するか-->
        <meta name="twitter:site" content="@junjiruw"><!--フッターに表示されるらしい…どこ？-->
        <link rel="stylesheet" href="../css/style.css">
        
        <link rel="icon" href="../images/site/favicon32.png">
        <style>

            div#mannaka{
                width: 98%;
                margin: auto;
                background: #16151a;
                border: 2px solid #ffffff;
                color: #ffffff;   
                font-size: 16px;    
            }

            div#parent_div{
                text-align: center;
                margin: 10px;
            }
            canvas{
                background: #ffffff;
                height: 70vh;/*これ、PCブラウザで横に狭くしたら崩壊せえへん？→勝手に崩壊してろ*/
                /*image-rendering: pixelated;ドット絵を拡大したいなら使え*/
            }


            div#buttons{
                display: flex;
            }
            input.key_button{
                background-color: #FFFFFF;
                width: 1.5em;
                height: 1.5em;
                font-size: 2em;
                font-family: "misaki_gothic";
                margin: 0.25em;
                margin-left: 1em;
            }
            input.key_button:active{
                background-color: #656965;
                color: #FFFFFF;
            }
            div#button_left{
                text-align: left;
                width: 50%;
            }
            div#button_left div{
                text-align: center;
            }
            div#button_right{
                text-align: center;
                width: 50%;
            }

        </style>
        <script src="../js/public.js"></script>
        <script>
            //素材読み込み
            var test=new Image();
            test.src="../images/omocha/syuukun_card/200130.png";
            var test_syuukun=new Image();
            test_syuukun.src="../images/omocha/syuukun_card/test_syuukun200130.png";
            var turn_end=new Image();
            turn_end.src="../images/omocha/syuukun_card/ta-nendman.png";
            var yamahuda=new Image();
            yamahuda.src="../images/omocha/syuukun_card/yamahuda.png";
            var hakaba=new Image();
            hakaba.src="../images/omocha/syuukun_card/hakaba64.png";
            var card_basyo=new Image();
            card_basyo.src="../images/omocha/syuukun_card/card_basyo.png";
            var yubi=new Image();
            yubi.src="../images/omocha/syuukun_card/ka-soru64.png";//嘘。拡大したから128
            var atk_plate=new Image();
            atk_plate.src="../images/omocha/syuukun_card/atk_plate.png";
            var def_plate=new Image();
            def_plate.src="../images/omocha/syuukun_card/def_plate.png";
            var atk_circle=new Image();
            atk_circle.src="../images/omocha/syuukun_card/atk_circle.png";
            var zuba64=new Image();
            zuba64.src="../images/omocha/syuukun_card/zuba64.png";
            var kati_image=new Image();
            kati_image.src="../images/omocha/syuukun_card/syouhai300_kati.png";
            var make_image=new Image();
            make_image.src="../images/omocha/syuukun_card/syouhai300_make.png";
            //カード定義 effectを使うときはeffect()
            var test_card={name:"テストカード",image:test,ATK:1,HP:1,state:["モンスター","test"],effect:function(){console.log("name:"+this.name);},text:"オイラはテストカード！真っ赤な赤色がトレードマークさ！…ところで俺がめちゃくちゃ長い説明文を持ってたとしたらどうする？ぐげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげげ"};
            var test_card2={name:"テストカード2",image:test_syuukun,ATK:2,HP:3,state:["モンスター","test"],effect:function(){console.log("name:"+this.name);},text:"伝説のテストしゅうくん。あ、まって半角文字のテストしたい123456789aqswderfﾍｲﾍｲﾍｲﾄﾞｳﾅﾝﾀﾞｲﾍｲﾍｲ…いけるじゃん！"};
            //ここにゲームパラメータを置くとイイネ。
            var deck_list=[[test_card,38],[test_card2,2]];
            var my_deck=[];
                //my_deck[i]={card:test_card,ATK:1,HP:1,state:[],position:"my_yamahuda",can_ATK:0};
            var teki_deck=[];
            var my_yamahuda=[];
            var teki_yamahuda=[];
            var my_tehuda=[];
            var teki_tehuda=[];
            var my_ba=["","","","",""];
            /*
                my_ba[i]=my_deck[i+5];
                my_ba[i].position="my_ba_"+i;
                my_ba[i].can_ATK=1;
            */

            var teki_ba=["","","","",""];
            var death_my_ba=["","","","",""];//死亡時演出のためにカードを別の場所に移したい（場に残すとバグの温床になることは自明なので）
            var death_teki_ba=["","","","",""];
            
            var my_haka=[];
            var teki_haka=[];
            //キーボードなど、システムの、あの、アレ、アレさ！
            var key_input="";
            var what_input="";//キーボード同時おしに使う
            var key_interval=0;//n*10[s]　長押しの連続入力に使ってる
            var key_owarasete=0;

            var cursor=16;
            var pre_cursor;

            var duel_phase="自由";
            var aite_phase=0;//相手のターンに動かしたい。
            var aite_nayami;//相手ターンの悩みフェーズに使うなんか用途不明の変数だ！
            var aite_delay=0;//お前高速で動きすぎ！

            var atk_card;
            var def_card;
            var tukau_card_num;

            var syousai_card;
            var syousai_state;

            var tehuda_maisuu=0;//手札の角度覚えるのに使ってる
            var card_kankaku=0;
            var kakudo=10;

            var zuba=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]//zuba64を表示するタイマー

            var time=0;

            onload = function(){
                onload_functions();
                const cnvs = document.getElementById('cnvs');//IDを指定して変数にぶち込む
                const ctx = cnvs.getContext("2d");
                ctx.font = "50px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。

                if (navigator.userAgent.match(/iPhone|Android.+Mobile/)) {//貴様！スマホで見ているな！？
                    cnvs.style.width=100+"%";
                    cnvs.style.height=cnvs.clientWidth+"px";
                }

                var buttons = document.getElementsByClassName("key_button");//ボタン操作
                if( window.ontouchstart === null ){ // 注：ontouchstartが存在しない時は undefined が返る
                    //ようするにタッチ機能がある端末なら
                    for(let i=0;i<buttons.length;i++){
                        buttons[i].addEventListener("touchstart",function(e){//押すと動く
                            e.preventDefault();//ボタンをもとの状態に戻してください（血涙）
                            key_input=this.value;
                            key_interval=-1;//初回限定モード（1回は動作させたいので。）
                            key_owarasete=0;
                        });
                        buttons[i].addEventListener("touchend",function(e){//離すと動く
                            e.preventDefault();//ボタンをもとの状態に戻してください（血涙）
                            if(key_interval!=-1){//一回も実行されてないのに終了するのはボタンとしておかしいので、はじく
                                key_input="";
                                key_interval=0;//長押しの連続入力に使ってるだけなので長押しが終わったら初期化するんよ
                            }else{
                                key_owarasete=1;//一度も実行されてないけど、ボタンはもう押してないのよ。
                            }
                        });
                    }
                }else{
                    //一般的なPCなら
                    for(let i=0;i<buttons.length;i++){
                        buttons[i].addEventListener("mousedown",function(){//押すと動く
                            key_input=this.value;
                            key_interval=-1;//初回限定モード（1回は動作させたいので。）
                            key_owarasete=0;
                        });
                        buttons[i].addEventListener("mouseup",function(){//離すと動く
                            if(key_interval!=-1){//一回も実行されてないのに終了するのはボタンとしておかしいので、はじく
                                key_input="";
                                key_interval=0;//長押しの連続入力に使ってるだけなので長押しが終わったら初期化するんよ
                            }else{
                                key_owarasete=1;//一度も実行されてないけど、ボタンはもう押してないのよ。
                            }
                        });

                    }
                }
                
                document.addEventListener('keydown', function(key){//キーボード操作

                    what_input="";
                    if(key.key=="w" || key.key=="k" || key.key=="ArrowUp"){
                        what_input="↑";
                    }else if(key.key=="a" || key.key=="h" || key.key=="ArrowLeft"){
                        what_input="←";
                    }else if(key.key=="d" || key.key=="l" || key.key=="ArrowRight"){
                        what_input="→";
                    }else if(key.key=="s" || key.key=="j" || key.key=="ArrowDown"){
                        what_input="↓";
                    }else if(key.key=="Enter"){
                        what_input="〇";
                    }else if(key.key=="Shift"){
                        what_input="×";
                    }
                    if(key_input.indexOf(what_input)==-1){//すでに押されていたら、文字列検索でひっかかる。ひっかからないなら-1が帰ってくる
                        key_input=key_input+what_input;//キーボードは同時押しが可能なので書き換えではなく、追加にします。え？キーボードとボタン同時押しされたら？バ～カ
                    }
                    if (what_input != ""){key.preventDefault();}//矢印キーでの操作時に、画面が上下にスクロールしてしまうことを防ぐ

                    
                });
                document.addEventListener('keyup', function(key){//キーボード操作
                    what_input="";
                    if(key.key=="w" || key.key=="ArrowUp"){
                        what_input="↑";
                    }else if(key.key=="a" || key.key=="ArrowLeft"){
                        what_input="←";
                    }else if(key.key=="d" || key.key=="ArrowRight"){
                        what_input="→";
                    }else if(key.key=="s" || key.key=="ArrowDown"){
                        what_input="↓";
                    }else if(key.key=="Enter"){
                        what_input="〇";
                    }else if(key.key=="Shift"){
                        what_input="×";
                    }
                    
                    key_input=key_input.slice(0,key_input.indexOf(what_input))+key_input.slice(key_input.indexOf(what_input)+1);//該当文字を消去
                    if(key_input==""){
                        key_interval=0;//長押しの連続入力に使ってるだけなので長押しが終わったら初期化するんよ
                    }
                });

                function card_draw(print_card,x,y,of_y=0){
                    ctx.drawImage(print_card.card.image,x,y+of_y);
                    ctx.drawImage(atk_plate,x,y+104+of_y);
                    ctx.drawImage(def_plate,x,y+152+of_y);
                    ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                    ctx.fillStyle="rgb(255,255,255)";
                    if(print_card.ATK<10){
                        ctx.fillText(print_card.ATK, x+13, y+146+of_y);
                    }else{
                        ctx.fillText(print_card.ATK, x+3, y+146+of_y);
                    }
                    if(print_card.HP<10){
                        ctx.fillText(print_card.HP, x+13, y+188+of_y);
                    }else{
                        ctx.fillText(print_card.HP, x+3, y+188+of_y);
                    }
                    if(print_card.can_ATK!=0){//攻撃可能モンスターにはマークを表示、複数攻撃マンが実装されたら変更してちょ
                        ctx.drawImage(atk_circle,x+10+10*Math.sin(time*Math.PI/64),y+20+8*Math.sin(time*Math.PI/16)+of_y);
                    }
                }
                function death_card(shi_card,haka,doko){
                    if(haka==teki_haka){
                        shi_card.position="teki_haka";
                        death_teki_ba[doko]=shi_card;
                        death_teki_ba[doko].move=10;
                    }else{
                        shi_card.position="my_haka";
                        death_my_ba[doko]=shi_card;
                        death_my_ba[doko].move=10;
                    }
                    shi_card.HP=shi_card.card.HP;//回復
                    shi_card.state=shi_card.card.state;//回復
                    shi_card.can_ATK=0;//攻撃不可
                    haka.push(shi_card);//GO墓場
                    
                    return "";//場から除去するためにこいつをba_i[n]に代入しておいてくれ。
                    
                }
                function deck_initialize(list,deck,yamahuda){
                    //my_deck[i]={card:test_card,ATK:1,HP:1,state:[],position:"my_yamahuda",can_ATK:0};
                    var doko_position;
                    if(deck==my_deck){
                        doko_position="my_yamahuda";//自デッキの初期化なら自分の山札に入れてね
                    }else{
                        doko_position="teki_yamahuda";//敵だね。
                    }
                    var nani_card;
                    var imano_num;
                    imano_num=0;
                    for(let i=0;i<list.length;i++){
                        nani_card=list[i][0];//このカードn枚山札に入れるぜ！
                        for(let j=0;j<list[i][1];j++){
                            deck[imano_num]={card:nani_card};//ここだけ描き方が違うのはな、しかたないんやなって
                            deck[imano_num].ATK=nani_card.ATK;
                            deck[imano_num].HP=nani_card.HP;
                            deck[imano_num].state=nani_card.state;//ここでエースモンスターの設定をしたいね。
                            deck[imano_num].position=doko_position;
                            deck[imano_num].can_ATK=0;//これは攻撃可能かどうかを意味するぞ！山札から攻撃しないでくれよな！（いや、できるやつがいずれでるかもしれんが）
                            yamahuda[imano_num]=deck[imano_num];//とりあえず全部山札にぶちこんでやるぜ～！
                            imano_num+=1;
                        }
                    }
                    //ここでシャッフルすべきよ！そうだわ！
                }
                function pull_card(yamahuda,tehuda=undefined,maisuu){
                    if(yamahuda.length<maisuu){
                        maisuu=yamahuda.length;//山札にカードがないのに引くんじゃない
                    }
                    if(yamahuda==my_yamahuda){//自デッキの初期化なら自分の山札に入れてね
                        for(let i=0;i<maisuu;i++){
                            tehuda[tehuda.length]=yamahuda[yamahuda.length-1];
                            tehuda[tehuda.length-1].position="my_tehuda_"+(tehuda.length-1+i);
                            yamahuda.splice(-1,1);//ドローしたので山札減ります。
                        }
                    }else{//敵だね。
                        for(let i=0;i<maisuu;i++){
                            tehuda[tehuda.length]=yamahuda[yamahuda.length-1];
                            tehuda[tehuda.length-1].position="teki_tehuda_"+(tehuda.length-1+i);
                            yamahuda.splice(-1,1);//ドローしたので山札減ります。
                        }
                    }
                    
                    
                }
                function atk_yamahuda(atk,yamahuda,haka,ba,tehuda){
                    
                    if(yamahuda==teki_yamahuda){//敵への攻撃さ！
                        if(atk>yamahuda.length){//はい死亡～！お前の負け✋
                            atk=yamahuda.length;
                            duel_phase="俺勝ち";                            
                        }
                        for(let i=0;i<atk;i++){
                            haka[haka.length]=yamahuda[yamahuda.length-1];//エースモンスターの場合は別にやる必要があるべ。
                            haka[haka.length-1].position="teki_haka";
                            yamahuda.splice(-1,1);
                        }
                    }else{
                        if(atk>yamahuda.length){//はい死亡～！俺の負け👍
                            atk=yamahuda.length;
                            duel_phase="敵勝ち";
                        }
                        for(let i=0;i<atk;i++){
                            haka[haka.length]=yamahuda[yamahuda.length-1];//エースモンスターの場合は別にやる必要があるべ。
                            haka[haka.length-1].position="my_haka";
                            yamahuda.splice(-1,1);
                        }
                    }
                }
                function ba_mons_num(ba){
                    var num_of_mons;
                    num_of_mons=0;
                    for(let i=0;i<5;i++){
                        if(ba[i]!=""){
                            num_of_mons+=1;
                        }
                    }
                    return num_of_mons;
                }
                function text_kaigyou_hyouji(txt,x,y,x_haba,y_haba,moji_zenkaku){//テキストをcanvasでも改行してくれるんや！
                    var txt_array;
                    var past_i;
                    txt_array=[];
                    past_i=0;
                    ctx.font = moji_zenkaku+"px  'ＭＳ ゴシック'";//フォント設定。
                    for (let i=0; i<txt.length; i++){
                        if(ctx.measureText(txt.substr(past_i,i-past_i+2)).width > x_haba){
                            txt_array[txt_array.length]=txt.substr(past_i,i-past_i+1);
                            past_i=i+1;
                        }
                    }
                    if(past_i!=txt.length){//切り取り余ってますよ
                        txt_array[txt_array.length]=txt.substr(past_i);
                    }
                    if(txt_array.length+1>Math.floor(y_haba/moji_zenkaku)){//縦にはみ出してるぞ
                        text_kaigyou_hyouji(txt,x,y,x_haba,y_haba,moji_zenkaku-1);//ちょっと小さくなってやりなおしてこい
                    }else{
                        for (let i=0; i<txt_array.length; i++){
                            ctx.fillText(txt_array[i], x, y+(i+1)*moji_zenkaku);//文字を表示していくぜー！
                        }
                    }
                }
                function takusan_card_draw(card,x,y,x_haba,y_haba){
                    var kakudai;
                    var x_maisuu;
                    kakudai=1;
                    while(card.length>Math.floor(x_haba/(kakudai*140))*Math.floor(y_haba/(kakudai*210))){//拡大率を下げてカードが全部枠に入るように調整する
                        kakudai-=0.05;
                    }
                    x_maisuu=Math.floor(x_haba/(kakudai*140));
                    ctx.save();
                    ctx.scale(kakudai,kakudai);
                    for(let i=0;i<card.length;i++){
                        ctx.drawImage(card[i].card.image,x/kakudai+140*(i%x_maisuu),y/kakudai+210*(Math.floor(i/x_maisuu)));
                    }
                    ctx.restore();
                }

                deck_initialize(deck_list,my_deck,my_yamahuda);
                deck_initialize(deck_list,teki_deck,teki_yamahuda);
                pull_card(my_yamahuda,my_tehuda,3);
                /*
                for(let i=0;i<5;i++){
                    teki_ba[i]=teki_deck[39-i];
                    teki_ba[i].position="teki_ba_"+i;
                    teki_ba[i].move=5;
                }
                */
                //--------------------------------------------------------------------------------------------------------
                setInterval(function(){//1秒にn回動くぞ！
                    time+=1;
                    if(time==1000){
                        time=0;
                    }

                    if(key_interval<=0 && key_input!="" && duel_phase!="相手"){//キーが長押しされている場合はkey_intervalが0になってて、キー操作が飛んできたら
                        key_interval=3;//30*n/1000[s]の間、長押しでの連続入力を無効。
                        for(let i=0;i<key_input.length;i++){
                            if(key_input.charAt(i)=="↑"){
                                if(duel_phase=="自由"){
                                    if(cursor<=2){
                                        cursor=16;
                                    }else if(cursor<=5){
                                        cursor=15;
                                    }else if(cursor==6){
                                        cursor=-1;
                                    }else if(cursor==11){
                                        cursor=5;
                                    }else if(cursor>=7 && cursor<=15){
                                        cursor-=1;
                                    }else if(cursor>=16){
                                        cursor=10;
                                    }
                                }else if(duel_phase=="攻撃"){
                                    if(cursor!=3){//山札への攻撃じゃないなら
                                        cursor-=1;
                                        if(cursor<=10){
                                            cursor=15;
                                        }
                                    }
                                }else if(duel_phase=="召喚"){
                                    cursor-=1;
                                    if(cursor<=5){
                                        cursor=10;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="←"){
                                if(duel_phase=="自由"){
                                    if(cursor==-1){
                                        cursor=5;
                                    }else if(cursor<=5){ 
                                    cursor-=1;
                                    }else if(cursor>=11 && cursor<=15){
                                        cursor-=5;
                                    }else if(cursor>=17){
                                        cursor-=1;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="→"){
                                if(duel_phase=="自由"){
                                    if(cursor<=4){
                                        cursor+=1;
                                    }else if(cursor==5){
                                        cursor=-1;
                                    }else if(cursor>=6 && cursor<=10){
                                        cursor+=5;
                                    }else if(cursor>=16 && cursor<=(my_tehuda.length+14)){
                                        cursor+=1;
                                }
                                }
                                
                            }else if(key_input.charAt(i)=="↓"){
                                if(duel_phase=="自由"){
                                    if(cursor<=2){
                                        cursor=6;
                                    }else if(cursor<=5){
                                        cursor=11;
                                    }else if(cursor<=9){
                                        cursor+=1;
                                    }else if(cursor==10){
                                        cursor=16;
                                    }else if(cursor<=15){
                                        cursor+=1;
                                    }else{
                                        cursor=-1;
                                    }
                                }else if(duel_phase=="攻撃"){
                                    if(cursor!=3){//山札への攻撃じゃないなら
                                        cursor+=1;
                                        if(cursor>=16){
                                            cursor=11;
                                        }
                                    }
                                }else if(duel_phase=="召喚"){
                                    cursor+=1;
                                    if(cursor>=11){
                                        cursor=6;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="〇"){
                                if(duel_phase=="自由"){
                                    if(cursor==-1){
                                        duel_phase="相手";
                                        aite_phase="始まり";
                                        cursor=16;
                                    }else if(cursor>=6 && cursor<=10 && my_ba[cursor-6]!=""){
                                        pre_cursor=cursor;//キャンセルしたときにここに戻してあげたいよね。
                                        atk_card=my_ba[cursor-6];//こちらの攻撃カード
                                        if(atk_card.can_ATK>=1){
                                            duel_phase="攻撃";
                                            if(ba_mons_num(teki_ba)==0){
                                                cursor=3;//敵がいない場合は山札にカーソル合わせてほしいな
                                            }else{
                                                cursor=11;
                                                for(let i=0;i<4;i++){//敵がいるところにカーソル合わせようぜ。
                                                    if(teki_ba[cursor-11]==""){
                                                        cursor+=1;
                                                    }else{
                                                        break;
                                                    }
                                                }
                                            }
                                            
                                        }
                                        

                                    }else if(cursor>=16 && my_tehuda.length!=0){
                                        pre_cursor=cursor;//キャンセルしたときにここに戻してあげたいよね。
                                        tukau_card_num=cursor-16;
                                        if(my_tehuda[tukau_card_num].state.indexOf("モンスター")!=-1){//手札にあったモンスターカードを選んだな！
                                            if(ba_mons_num(my_ba)!=5){//場がいっぱいじゃないので、いや、生贄召喚系ならいっぱいでもいいのか
                                                duel_phase="召喚";
                                                cursor=10;
                                                for(let i=0;i<4;i++){//カードがないところにカーソル合わせようぜ。
                                                    if(my_ba[cursor-6]!=""){
                                                        cursor-=1;
                                                    }else{
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }else if(duel_phase=="攻撃"){
                                    if(cursor==3){//ダイレクトアタック！
                                        atk_yamahuda(atk_card.ATK,teki_yamahuda,teki_haka,teki_ba,teki_tehuda);
                                        atk_card.can_ATK-=1;//攻撃可能回数が1減る
                                        my_ba[pre_cursor-6].move=-3;
                                        cursor=pre_cursor;
                                        zuba[3]=6;
                                        if(duel_phase=="攻撃"){//これが通らなかったらどっちかが負けてる
                                            duel_phase="自由";
                                        }
                                        
                                    }else if(teki_ba[cursor-11]!=""){//相手のいる場所を攻撃
                                        def_card=teki_ba[cursor-11];
                                        def_card.HP-=atk_card.ATK;
                                        if(def_card.HP<=0){//倒した～
                                            teki_ba[cursor-11]=death_card(def_card,teki_haka,cursor-11);
                                            //teki_ba[cursor-11]="";になるよん
                                            //def_card="";ではだめ。参照はプロパティの場所しか渡せてないらしい、じゃあ渡せばいいじゃん！やだよバーカ！
                                        }
                                        atk_card.can_ATK-=1;//攻撃可能回数が1減る
                                        my_ba[pre_cursor-6].move=-3;
                                        teki_ba[cursor-11].move=2;
                                        zuba[cursor]=6;
                                        cursor=pre_cursor;
                                        duel_phase="自由";
                                    }
                                }else if(duel_phase=="召喚"){
                                    //生贄召喚とかほしいね、知らん。
                                    if(my_ba[cursor-6]==""){//あいてるじゃ～ん
                                        my_ba[cursor-6]=my_tehuda[tukau_card_num];
                                        my_ba[cursor-6].position="my_ba_"+(cursor-6);
                                        my_ba[cursor-6].can_ATK=1;//召喚時効果によっては変わるかもね
                                        my_ba[cursor-6].move=5;
                                        my_tehuda.splice(tukau_card_num,1);
                                        duel_phase="自由";
                                    }
                                    
                                }
                                
                            }else if(key_input.charAt(i)=="×"){
                                if(duel_phase=="自由"){
                                    
                                }else if(duel_phase=="攻撃"){
                                    duel_phase="自由";
                                    cursor=pre_cursor;
                                }else if(duel_phase=="召喚"){
                                    duel_phase="自由";
                                    cursor=pre_cursor;
                                }
                            }
                        }
                        if(key_owarasete==1){//もうボタン押してない。押してないときはイベントくんで検知するんだけど、実行よりも先にイベントが呼ばれてたらしかたないのでこいつで止める
                            key_input="";
                            key_interval=0;
                        }
                    }else if(key_interval>0){
                        key_interval=key_interval-1;//カウントダウン
                    }

                    if(duel_phase=="相手"){
                        if(aite_delay>0){
                            aite_delay-=1;
                        }else if(aite_phase=="始まり"){
                            for(let i=0;i<5;i++){
                                if(my_ba[i]!=""){
                                    my_ba[i].can_ATK=1;//効果によっては変わるかもね
                                }
                            }
                            pull_card(teki_yamahuda,teki_tehuda,2);//相手の手札枚数は右上のあそこに表示してあげるとやさしいと思うな。
                            teki_siyou_tehuda=[];
                            aite_phase="召喚";
                        }else if(aite_phase=="召喚"){
                            aite_nayami="悩むぜ！";
                            for(let i=0;i<teki_tehuda.length;i++){//手札使うぜ！    
                                if(teki_tehuda[i].state.indexOf("モンスター")!=-1){//モンスターカードやんけ！
                                    for(let j=0;j<5;j++){
                                        if(teki_ba[j]==""){//空いてる場所あるじゃん！
                                            teki_ba[j]=teki_tehuda[i];
                                            teki_ba[j].position="teki_ba_"+(j);
                                            teki_ba[j].can_ATK=1;//召喚時効果によっては変わるかもね
                                            teki_ba[j].move=5;
                                            aite_delay=5;
                                            teki_tehuda.splice(aite_phase,1);
                                            aite_nayami="手札使ったよ";
                                            break;//
                                        }
                                    }
                                }
                                if(aite_nayami=="手札使ったよ"){
                                    break;//手札一枚使ったらループしなおしてきて
                                }
                            }
                            if(aite_nayami=="悩むぜ！"){//やることなくなった？
                                aite_phase="攻撃";
                                aite_delay=3;
                            }
                        }else if(aite_phase=="攻撃"){
                            aite_nayami="悩むぜ！";
                            for(let i=0;i<5;i++){//攻撃力が一番高いやつを見つけるぜ！
                                if(teki_ba[i]!=""){
                                    if(teki_ba[i].can_ATK>0){
                                        if(aite_nayami=="悩むぜ！"){
                                            aite_nayami=i;
                                        }else if(teki_ba[aite_nayami].ATK<teki_ba[i].ATK){//攻撃力が高いやつから攻撃しようぜ（これがいいのかは…知らん。）
                                            aite_nayami=i;
                                        }
                                    }
                                }
                            }
                            if(aite_nayami=="悩むぜ！"){//攻撃できるカードがなかったぜ！
                                aite_phase="終わり";
                            }else{
                                teki_ba[aite_nayami].move=-3;
                                aite_delay=10;
                                atk_card=teki_ba[aite_nayami];
                                aite_nayami="悩むぜ！";

                                for(let i=0;i<5;i++){//体力とか攻撃力を加味して攻撃相手を決めたいぜ！
                                    if(my_ba[i]!=""){
                                        if(aite_nayami=="悩むぜ！"){
                                            aite_nayami=i;
                                        }else if(my_ba[aite_nayami].ATK/Math.ceil(my_ba[aite_nayami].HP/atk_card.ATK)<my_ba[i].ATK/Math.ceil(my_ba[i].HP/atk_card.ATK)){//なんか殺しやすくて強いやつを殴ろう
                                            aite_nayami=i;
                                        }
                                    }
                                }

                                if(aite_nayami=="悩むぜ！"){//俺の場がガラ空きだぁ
                                    atk_yamahuda(atk_card.ATK,my_yamahuda,my_haka,my_ba,my_tehuda);
                                    if(duel_phase!="相手"){
                                        aite_phase="終わり";//どっちか負けたぞ
                                    }
                                    zuba[0]=6;
                                }else{
                                    def_card=my_ba[aite_nayami];
                                    def_card.HP-=atk_card.ATK;
                                    if(def_card.HP<=0){//倒した～
                                        my_ba[aite_nayami]=death_card(def_card,my_haka,aite_nayami);
                                        //my_ba[aite_nayami]="";になるよん
                                        //def_card="";ではだめ。参照はプロパティの場所しか渡せてないらしい、じゃあ渡せばいいじゃん！やだよバーカ！
                                    }
                                    my_ba[aite_nayami].move=2;
                                    zuba[aite_nayami+6]=6;
                                }
                                
                                atk_card.can_ATK-=1;//攻撃したら…ね
                            }
                        }else if(aite_phase=="終わり"){
                            duel_phase="自由";
                            pull_card(my_yamahuda,my_tehuda,3);
                            for(let i=0;i<5;i++){
                                if(teki_ba[i]!=""){
                                    teki_ba[i].can_ATK=1;//効果によっては変わるかもね
                                }
                            }
                        
                        }
                        
                    }
                    ctx.fillStyle="rgb(130,255,170)";
                    ctx.fillRect(0,0,1000,1000);
                    ctx.drawImage(card_basyo,0,0);

                    //ここで自分のフィールドにカードを並べる
                    ctx.save();
                    ctx.rotate(90 * Math.PI / 180);
                    for(let i=0;i<my_ba.length;i++){
                        if(my_ba[i].position=="my_ba_0"){//なんか妙な表示判定方法採用してますね…なんだこれは…
                            card_draw(my_ba[i],105,-205+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_1"){
                            card_draw(my_ba[i],240,-215+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_2"){
                            card_draw(my_ba[i],375,-225+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_3"){
                            card_draw(my_ba[i],510,-215+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_4"){   
                            card_draw(my_ba[i],645,-205+my_ba[i].move*50);
                        }
                        if(my_ba[i].move>0){
                            my_ba[i].move-=1;
                        }else if(my_ba[i].move<0){
                            my_ba[i].move+=1;
                        }
                    }
                    ctx.restore();
                                       

                    //ここで敵のフィールドにカードを並べる
                    ctx.save();
                    ctx.rotate(270 * Math.PI / 180);
                    for(let i=0;i<teki_ba.length;i++){
                        if(teki_ba[i].position=="teki_ba_0"){
                            card_draw(teki_ba[i],-235,795+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_1"){
                            card_draw(teki_ba[i],-370,785+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_2"){
                            card_draw(teki_ba[i],-505,775+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_3"){
                            card_draw(teki_ba[i],-640,785+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_4"){
                            card_draw(teki_ba[i],-775,795+teki_ba[i].move*50);
                        }
                        if(teki_ba[i].move>0){
                            teki_ba[i].move-=1;
                        }else if(teki_ba[i].move<0){
                            teki_ba[i].move+=1;
                        }
                    }
                    ctx.restore();

                    //自分カードの死
                    ctx.save();
                    ctx.rotate(90 * Math.PI / 180);
                    for(let i=0;i<5;i++){
                        if(death_my_ba[i]!=""){
                            card_draw(death_my_ba[i],105+135*i+(death_my_ba[i].move%2)*10,-225+(Math.abs(2-i)*10)+(10-death_my_ba[i].move)*30);
                        }
                        if(death_my_ba[i].move>0){
                            death_my_ba[i].move-=1;
                            if(death_my_ba[i].move==0){
                                death_my_ba[i]="";
                            }
                        }
                    }
                    ctx.restore();

                    //相手カードの死
                    ctx.save();
                    ctx.rotate(270 * Math.PI / 180);
                    for(let i=0;i<5;i++){
                        if(death_teki_ba[i]!=""){
                            card_draw(death_teki_ba[i],-235-135*i+(death_teki_ba[i].move%2)*10,775+(Math.abs(2-i)*10)+(10-death_teki_ba[i].move)*30);
                        }
                        if(death_teki_ba[i].move>0){
                            death_teki_ba[i].move-=1;
                            if(death_teki_ba[i].move==0){
                                death_teki_ba[i]="";
                            }
                        }
                    }
                    ctx.restore();
                    
                    //カードの詳細表示
                    if((cursor>=6 &&cursor<=10 && (my_ba[cursor-6]!="")) || (cursor>=11 && cursor<=15 && (teki_ba[cursor-11]!="")) || (cursor>=16 && my_tehuda.length!=0)){//カード詳細を表示するときはカードがあるときだけだぜ！
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        if(cursor<=10){
                            syousai_card=my_ba[cursor-6];
                        }else if(cursor<=15){
                            syousai_card=teki_ba[cursor-11];
                        }else{
                            syousai_card=my_tehuda[cursor-16];
                        }
                        ctx.fillStyle="rgb(200,200,200)";
                        ctx.fillRect(255,125,490,50);
                        ctx.font = "50px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText(syousai_card.card.name, 260, 168);
                        ctx.drawImage(syousai_card.card.image,260,180);

                        ctx.drawImage(atk_plate,400,180);
                        ctx.drawImage(def_plate,450,185);
                        ctx.fillText("(", 570, 225);
                        ctx.drawImage(atk_plate,600,180);
                        ctx.drawImage(def_plate,650,185);
                        ctx.fillText(")", 704, 225);
                        ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(255,255,255)";
                        if(syousai_card.ATK<10){
                            ctx.fillText(syousai_card.ATK, 414, 222);
                        }else{
                            ctx.fillText(syousai_card.ATK, 404, 222);
                        }
                        if(syousai_card.HP<10){
                            ctx.fillText(syousai_card.HP, 464, 222);
                        }else{
                            ctx.fillText(syousai_card.HP, 454, 222);
                        }
                        if(syousai_card.card.ATK<10){
                            ctx.fillText(syousai_card.card.ATK, 614, 222);
                        }else{
                            ctx.fillText(syousai_card.card.ATK, 604, 222);
                        }
                        if(syousai_card.card.HP<10){
                            ctx.fillText(syousai_card.card.HP, 664, 222);
                        }else{
                            ctx.fillText(syousai_card.card.HP, 654, 222);
                        }
                        ctx.fillStyle="rgb(0,0,0)";
                        text_kaigyou_hyouji(syousai_card.card.text, 260, 380,480,240,40);//x,yは左上指定だから注意だ！
                        ctx.fillRect(255,600,490,2);
                        syousai_state="分類:";
                        for(let i=0;i<syousai_card.state.length;i++){
                            syousai_state+=" "+syousai_card.state[i];
                        }
                        text_kaigyou_hyouji(syousai_state, 260, 610,480,160,40);//x,yは左上指定だから注意だ！
                    }

                    if(cursor==1){
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        takusan_card_draw(my_haka,260,130,480,630);
                    }else if(cursor==4){
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        takusan_card_draw(teki_haka,260,130,480,630);
                    }

                    ctx.fillStyle="rgb(0,0,0)";//上のほうを描いてます。
                    ctx.fillRect(105,5,440,90);
                    ctx.fillRect(555,5,440,90);
                    ctx.fillStyle="rgb(255,255,255)";
                    ctx.fillRect(110,10,430,80);
                    ctx.fillRect(560,10,430,80);
                    ctx.fillStyle="rgb(150,200,255)";
                    ctx.fillRect(388,12,150,76);
                    ctx.fillRect(838,12,150,76);
                    ctx.font = "50px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                    ctx.fillStyle="rgb(0,0,0)";
                    ctx.drawImage(turn_end,5,5);
                    ctx.drawImage(yamahuda,110,20);
                    ctx.fillText(my_yamahuda.length, 174, 70);
                    ctx.drawImage(yamahuda,560,20);
                    ctx.fillText(teki_yamahuda.length, 624, 70);
                    ctx.drawImage(hakaba,274,20);
                    ctx.fillText(my_haka.length, 338, 70);
                    ctx.drawImage(hakaba,724,20);
                    ctx.fillText(teki_haka.length, 788, 70);
                    
                    
                    

                    ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                    ctx.fillStyle="rgb(0,0,0)";
                    ctx.fillRect(5,785,990,210);
                    ctx.fillStyle="rgb(255,255,255)";
                    ctx.fillRect(10,790,980,200);
                    if(my_tehuda.length!=0){//ここから手札-------------------
                        ctx.save();
                        tehuda_maisuu=my_tehuda.length;
                        if(tehuda_maisuu<7){
                            card_kankaku=130;
                        }else{
                            card_kankaku=850/tehuda_maisuu;
                        }
                        kakudo=25/tehuda_maisuu;
                        ctx.rotate(10 * Math.PI / 180);
                       for (let i=0;i<tehuda_maisuu;i++){                      
                            if((cursor-16)==i || ((pre_cursor-16)==i && duel_phase=="召喚")){
                                card_draw(my_tehuda[i],(50+card_kankaku*i)*Math.cos((10+i*kakudo) * Math.PI / 180)+780*Math.sin((10+i*kakudo) * Math.PI / 180),780*Math.cos((10+i*kakudo) * Math.PI / 180)-(50+card_kankaku*i)*Math.sin((10+i*kakudo) * Math.PI / 180),-40);
                            }else{
                                card_draw(my_tehuda[i],(50+card_kankaku*i)*Math.cos((10+i*kakudo) * Math.PI / 180)+780*Math.sin((10+i*kakudo) * Math.PI / 180),780*Math.cos((10+i*kakudo) * Math.PI / 180)-(50+card_kankaku*i)*Math.sin((10+i*kakudo) * Math.PI / 180));
                            }
                            ctx.rotate(kakudo * Math.PI / 180);
                        }
                        ctx.restore();
                    }
                    

                    if(duel_phase=="召喚"){//今なんの状態なんだよっていうお客様の声にお答えする形になった
                        ctx.save();
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,230,100);
                        ctx.fillRect(0,780,230,220);
                        ctx.fillRect(230,0,770,1000);
                        ctx.rotate(45 * Math.PI / 180);
                        ctx.fillStyle="rgb(0,0,150)";
                        ctx.fillRect(200,-525,1000,200);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(400,-500,600,150);
                        ctx.font = "80px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(0,0,200)";
                        ctx.fillText("召喚場所選択！", 440, -400);
                        ctx.font = "30px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillText("キャンセル：×", 750, -360);
                        ctx.restore();
                    }else if(duel_phase=="攻撃"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,780,1000,100);
                        ctx.fillRect(230,100,540,680);
                        ctx.fillRect(0,100,230,(pre_cursor-6)*135);
                        ctx.fillRect(0,105+(pre_cursor-5)*135,230,(10-pre_cursor)*135);
                        if(cursor==3){
                            ctx.fillRect(0,0,550,100);
                            ctx.fillRect(700,0,300,100);
                            ctx.fillRect(770,100,230,800);
                        }else{
                            ctx.fillRect(0,0,1000,100);
                        }
                        ctx.fillStyle="rgb(150,0,0)";
                        ctx.fillRect(0,800,1000,200);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,825,600,150);
                        ctx.font = "80px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(200,0,0)";
                        ctx.fillText("攻撃対象選択！", 225, 900);
                        ctx.drawImage(atk_circle,100+10*Math.sin(time*Math.PI/64),850+8*Math.sin(time*Math.PI/16));
                        ctx.drawImage(atk_circle,836+10*Math.sin(time*Math.PI/64),850+8*Math.sin(time*Math.PI/16));
                        ctx.font = "30px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillText("キャンセル：×", 570, 960);
                    }else if(duel_phase=="相手"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,100,100);
                        ctx.fillRect(0,780,1000,220);
                        ctx.fillRect(0,100,15,680);
                        ctx.fillRect(985,0,15,780);
                        ctx.fillRect(100,0,885,15);
                        ctx.fillStyle="rgb(50,50,50)";
                        ctx.fillRect(230,100,540,680);
                        ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillText("相手ターン", 300, 300);
                        //ctx.fillText("召喚", 400, 400);
                    }else if(duel_phase=="俺勝ち"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(255,55,55)";
                        ctx.fillRect(150,100,700,700);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,150,600,600);

                        ctx.font = "80px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("勝った！", 250, 250);
                        ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillText("おめれと", 250, 350);
                        ctx.drawImage(kati_image,550,500);
                    }else if(duel_phase=="敵勝ち"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(55,55,255)";
                        ctx.fillRect(150,100,700,700);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,150,600,600);

                        ctx.font = "80px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("負けた！", 250, 250);
                        ctx.font = "40px  'ＭＳ ゴシック'";//フォント設定。左のフォントがないと右のフォントを適用するらしい。
                        ctx.fillText("ぐえー", 250, 350);
                        ctx.drawImage(make_image,550,525);
                    }
                    

                    for (let i=0;i<16;i++){ //攻撃時にzuba64を表示
                        if(zuba[i]!=0){
                            zuba[i]-=1;
                            if(i==0){
                                ctx.drawImage(zuba64,110,20);
                            }else if(i==1){
                            }else if(i==2){
                            }else if(i==3){
                                ctx.drawImage(zuba64,560,20);
                            }else if(i==4){
                            }else if(i==5){
                            }else if(i==6){
                                ctx.drawImage(zuba64,20,100);
                            }else if(i==7){
                                ctx.drawImage(zuba64,30,235);
                            }else if(i==8){
                                ctx.drawImage(zuba64,40,370);
                            }else if(i==9){
                                ctx.drawImage(zuba64,30,505);
                            }else if(i==10){
                                ctx.drawImage(zuba64,20,640);
                            }else if(i==11){
                                ctx.drawImage(zuba64,916,170);
                            }else if(i==12){
                                ctx.drawImage(zuba64,906,305);
                            }else if(i==13){
                                ctx.drawImage(zuba64,896,440);
                            }else if(i==14){
                                ctx.drawImage(zuba64,906,575);
                            }else if(i==15){
                                ctx.drawImage(zuba64,916,710);
                            }
                            
                        }
                    }
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    //カーソル表示…
                    if(cursor==-1){  ctx.drawImage(yubi,-10,80+4*Math.sin(time*Math.PI/8)); //左上 なんで-1から始まってるの？　それはね、設計ミスさ！
                    }else if(cursor==0){  ctx.drawImage(yubi,110,80+4*Math.sin(time*Math.PI/8)); 
                    }else if(cursor==1){  ctx.drawImage(yubi,260,80+4*Math.sin(time*Math.PI/8));
                    }else if(cursor==2){  ctx.drawImage(yubi,400,80+4*Math.sin(time*Math.PI/8));

                    }else if(cursor==3){ ctx.drawImage(yubi,560,80+4*Math.sin(time*Math.PI/8));//右上
                    }else if(cursor==4){ctx.drawImage(yubi,710,80+4*Math.sin(time*Math.PI/8));
                    }else if(cursor==5){ctx.drawImage(yubi,850,80+4*Math.sin(time*Math.PI/8));


                    }else if(cursor==6){//左場
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,105,-100+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==7){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,245,-110+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==8){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,375,-120+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==9){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,510,-110+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==10){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,645,-100+4*Math.sin(time*Math.PI/8));
                        ctx.restore();

                    }else if(cursor==11){//右ば
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-235,900+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==12){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-370,890+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==13){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-505,880+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==14){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-640,890+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==15){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-775,900+4*Math.sin(time*Math.PI/8));
                        ctx.restore();

                    }else{//手札でヤンス。
                        ctx.save();
                        ctx.rotate((10+kakudo*(cursor-16)) * Math.PI / 180);
                        ctx.drawImage(yubi,(50+card_kankaku*(cursor-16))*Math.cos((10+(cursor-16)*kakudo) * Math.PI / 180)+780*Math.sin((10+(cursor-16)*kakudo) * Math.PI / 180),100+4*Math.sin(time*Math.PI/8)+780*Math.cos((10+(cursor-16)*kakudo) * Math.PI / 180)-(50+card_kankaku*(cursor-16))*Math.sin((10+(cursor-16)*kakudo) * Math.PI / 180));
                        ctx.restore();
                    }
                    
                },30);//30/1000[s]でくりかえすぞ！
                
            }
            
        </script>
    </head>
    <body>


        <div id="top"></div>
        <header id="header">
            <button onclick="html_link_btn()" id="html_link_btn"></button>
            <nav id="html_link_nav">
                <ul id="html_link_ul"></ul>
            </nav>
            <a href="../index.html">
                <img id="go_home" src="../images/site/omotyabako_deka.png" alt="トップページへ" height="1px"><!--ここで高さを入れておかないと、クソでかい画像が一瞬読み込まれてボタンの大きさが暴走する-->
            </a>
            <h1 id="title_h1">
                JUN汁ｗおもちゃばこ。
            </h1>
        </header>

        <div id="mannaka">

            <table border="5" bordercolor="#ffffff" align="center">
                <tr>
                    <td> キーボード</td> <td bgcolor="#005000">移動 : WASD,↑←→↓,KHLJ</td> <td bgcolor="#500000">〇 : Enter</td> <td bgcolor="#000050">× : Shift</td>
                </tr>
            </table> 
            
            <div id="parent_div">
                <canvas id="cnvs" height="1000px" width="1000px"><!--styleのheigthは見た目の大きさを変えているにすぎない。表示領域はcssじゃない。-->
                </canvas>
            </div>
            <div id="buttons">
                <div id="button_left">
                    <div>
                        <input type="button" class="key_button" value="↑">
                    </div>
                    <div>
                        <input type="button" class="key_button" value="←">
                        <input type="button" class="key_button" value="→">
                    </div>
                    <div>
                        <input type="button" class="key_button" value="↓">
                    </div>
                    
                </div>
                <div id="button_right">
                    <input type="button" class="key_button" value="〇">
                    <input type="button" class="key_button" value="×">
                </div>
            </div>
            

            <footer>
                <ul id="footul">
                    <li id="foot_tweet_li">
                        <a href="" id="foot_tweet_a"><!--onload_functions()でhrefを書き込んでるで！-->
                            <img src="../images/site/twitterbutton.gif" alt="ツイートボタン" id="tweet_img">
                        </a>
                    </li>
                    <li>
                        <a href="#top" id="totop"> 
                            ページ上部に移動
                        </a>
                    </li>
                </ul>
            </footer>
        </div>
    </body>
</html>
